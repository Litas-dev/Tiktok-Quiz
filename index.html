<!DOCTYPE html>
<html lang="lt">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
<meta name="theme-color" content="#0A0F1F"/>
<title>Kostelio klausimynas — v2.8 mobile</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
  <header class="topbar">
    <button class="hamburger" id="hamburger" aria-label="Meniu">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M3 6h18M3 12h18M3 18h18"/>
      </svg>
    </button>
    <div class="brand">Kostelio klausimynas</div>
    <div class="ver">v2.8</div>
    <div class="spacer"></div>
    <nav class="topnav">
      <button class="navbtn" onclick="nav('home')">Pradžia</button>
      <button class="navbtn" onclick="nav('game')">Žaidimas</button>
      <button class="navbtn" onclick="nav('settings')">Nustatymai</button>
      <button class="navbtn" onclick="openLeaderboard()">Lyderių lentelė</button>
    </nav>
  </header>

  <aside id="sidebar" class="sidebar">
    <button class="sbtn" onclick="nav('home');toggleMenu(false)">Pradžia</button>
    <button class="sbtn" onclick="nav('game');toggleMenu(false)">Žaidimas</button>
    <button class="sbtn" onclick="nav('settings');toggleMenu(false)">Nustatymai</button>
    <button class="sbtn" onclick="openLeaderboard();toggleMenu(false)">Lyderių lentelė</button>
  </aside>

  <main>
    <section id="home" class="section active">
      <div class="board">
        <h1 class="title">Kostelio klausimynas</h1>
        <div class="card rules">
          <div style="text-align:center; font-weight:900; font-size:clamp(18px,3.4vw,26px); margin-bottom:6px">Taisyklės</div>
          <ul>
            <li>Žaidėjai atsako BALSU. Chat tiltas fiksuoja tik „A/B/C/D“ ar „1/2/3/4“.</li>
            <li>Laikmatis matomas juosta. Atsakymai priimami tik kol laikas BĖGA.</li>
            <li>+10 taškų už teisingą. Fiksuojamas pirmas atsakymas, keisti negalima.</li>
          </ul>
          <div style="text-align:center; font-weight:900; font-size:clamp(18px,3.4vw,26px); margin:10px 0 6px">Draugai</div>
          <ul>
            <li>Muzika (Absurd World)</li>
          </ul>
          <div style="text-align:center; margin-top:12px">
            <button class="btn ok" onclick="nav('game');startGame()">Start</button>
          </div>
        </div>
      </div>
    </section>

    <section id="game" class="section">
      <div class="board">
        <div class="timerWrap">
          <div class="bar"><div id="timerFill" class="fill"></div></div>
          <div class="trow">
            <div>Laikas: <span id="tLeft">0</span>s</div>
            <div>Ratas: <span id="roundNum">0</span></div>
          </div>
        </div>

        <div id="q">Klausimas pasirodys čia.</div>
        <div id="ans"></div>

        <div class="controls">
          <button id="startBtn" class="btn ok" onclick="startGame()">Start</button>
          <button id="lockBtn" class="btn warn hidden" onclick="lockNow()">Užrakinti</button>
          <button id="revealBtn" class="btn ok hidden" onclick="reveal(false)">Rodyti atsakymą</button>
          <button id="nextBtn" class="btn alt hidden" onclick="proceed()">Tęsti</button>
        </div>

        <div class="micro">
          <label><input id="autoNext" type="checkbox" onchange="state.settings.autoNext=this.checked; save()"> Auto kitas</label>
          <label>Trukmė
            <input id="secsPerQ" class="input" type="number" min="5" max="120" value="20"
              onchange="state.settings.secsPerQuestion=clamp(parseInt(this.value)||20,5,120); save()"> s
          </label>
        </div>
      </div>
    </section>

    <section id="settings" class="section">
      <div class="board">
        <div class="grid2">
          <div class="card">
            <h3 style="margin:0 0 8px">Klausimų bankas</h3>
            <input id="jsonFile" class="input" type="file" accept=".json" onchange="loadJSON(this.files[0])"/>
            <div id="bankStat" class="muted" style="margin-top:8px">Neužkrauta</div>
          </div>
          <div class="card">
            <h3 style="margin:0 0 8px">Garsai</h3>
            <label><input type="checkbox" id="sndTick" checked onchange="state.settings.sounds.ticking=this.checked; save()"> Tiksėjimas</label><br/>
            <label><input type="checkbox" id="sndFail" checked onchange="state.settings.sounds.fail=this.checked; save()"> Nesėkmės garsas</label>
          </div>
          <div class="card">
            <h3 style="margin:0 0 8px">Chat tiltas</h3>
            <label>WebSocket URL
              <input id="wsUrl" class="input" value="ws://localhost:8081"/>
            </label>
            <div style="margin-top:8px">
              <button class="btn" onclick="connectWS()">Prisijungti</button>
              <span id="wsState" class="muted">neprijungta</span>
            </div>
            <div class="muted" style="margin-top:8px">Laukiamas formatas: <code>{type:'chat', userId:'...', displayName:'...', avatar:'...', text:'...'}</code></div>
          </div>
          <div class="card">
            <h3 style="margin:0 0 8px">Versija</h3>
            <div>v2.8 mobile-first</div>
            <div class="muted">Avatarai ir slapyvardžiai iš WS. „curr“ lock. Tik kai bėga laikas.</div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <button class="float-lb" onclick="openLeaderboard()">Lyderių lentelė</button>

  <div id="overlay" class="overlay">
    <div class="card">
      <div class="answerBig" id="ovAnswer"></div>
      <div class="note" id="ovNote"></div>
      <div class="winners">
        <div class="row" style="font-weight:900"><div>Teisingai atsakė</div><div>Taškai</div></div>
        <div id="ovWinners"></div>
      </div>
      <div style="text-align:center; margin-top:12px">
        <button class="btn ok" id="closeOverlayBtn" onclick="proceed()">Tęsti</button>
      </div>
    </div>
  </div>

  <div id="lbModal" class="overlay">
    <div class="card">
      <div style="text-align:center; font-weight:1000; font-size:22px; margin-bottom:6px">Lyderių lentelė</div>
      <div class="lbList" id="lbList"></div>
      <div style="text-align:center; margin-top:12px">
        <button class="btn" onclick="closeLeaderboard()">Uždaryti</button>
      </div>
    </div>
  </div>

  <audio id="tickAudio" src="clock-67787.mp3" preload="auto" loop></audio>
  <audio id="failAudio" src="no-luck-too-bad-disappointing-sound-effect-112943.mp3" preload="auto"></audio>

  <script src="app.js"></script>
</body>
</html>
